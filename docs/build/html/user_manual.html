
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>User manual &#8212; SBpipe 4.6.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4.6.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Developer manual" href="developer_manual.html" />
    <link rel="prev" title="SBpipe documentation" href="index.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="developer_manual.html" title="Developer manual"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="SBpipe documentation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SBpipe 4.6.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="user-manual">
<h1>User manual<a class="headerlink" href="#user-manual" title="Permalink to this headline">¶</a></h1>
<div class="section" id="metadata">
<h2>Metadata<a class="headerlink" href="#metadata" title="Permalink to this headline">¶</a></h2>
<p>Copyright © 2015-2018, Piero Dalle Pezze and Nicolas Le Novère.</p>
<p>SBpipe and its documentation are released under the GNU Lesser General
Public License v3 (LGPLv3). A copy of this license is provided with the
package and can also be found here:
<a class="reference external" href="https://www.gnu.org/licenses/lgpl-3.0.txt">https://www.gnu.org/licenses/lgpl-3.0.txt</a>.</p>
<p>Contacts: Dr Piero Dalle Pezze (piero.dallepezze AT gmail.com) and Dr
Nicolas Le Novère (lenov AT babraham.ac.uk)</p>
<p>Affiliation: The Babraham Institute, Cambridge, CB22 3AT, UK</p>
<p>Mailing list: sbpipe AT googlegroups.com</p>
<p>Forum: <a class="reference external" href="https://groups.google.com/forum/#!forum/sbpipe">https://groups.google.com/forum/#!forum/sbpipe</a></p>
<p>Citation:</p>
<p>Dalle Pezze, P and Le Novère, N. (2017) <em>BMC Systems Biology</em> <strong>11</strong>:46.
SBpipe: a collection of pipelines for automating repetitive simulation
and analysis tasks.
<a class="reference external" href="https://doi.org/10.1186/s12918-017-0423-3">DOI:10.1186/s12918-017-0423-3</a></p>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This package contains a collection of pipelines for dynamic modelling of
biological systems. It aims to automate common processes and speed up
productivity for tasks such as model simulation, single/double parameter
scan, and parameter estimation.</p>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<p>In order to use SBpipe, the following software must be installed:</p>
<ul class="simple">
<li>Python 2.7+ or 3.4+ - <a class="reference external" href="https://www.python.org/">https://www.python.org/</a></li>
<li>R 3.3.0+ - <a class="reference external" href="https://cran.r-project.org/">https://cran.r-project.org/</a></li>
</ul>
<p>SBpipe can work with the following simulators:</p>
<ul class="simple">
<li>COPASI 4.19+ - <a class="reference external" href="http://copasi.org/">http://copasi.org/</a> (for model simulation, parameter
scan, and parameter estimation)</li>
<li>Python (directly or as a wrapper to call models coded in any
programming language)</li>
</ul>
<p>If LaTeX/PDF reports are also desired, the following software must also
be installed:</p>
<ul class="simple">
<li>LaTeX 2013+</li>
</ul>
</div>
<div class="section" id="how-to-install-sbpipe-on-gnu-linux">
<h3>How to install SBpipe on GNU/Linux<a class="headerlink" href="#how-to-install-sbpipe-on-gnu-linux" title="Permalink to this headline">¶</a></h3>
<div class="section" id="install-copasi">
<h4>Install COPASI<a class="headerlink" href="#install-copasi" title="Permalink to this headline">¶</a></h4>
<p>As of 2016, COPASI is not available as a package in GNU/Linux
distributions. Users must add the path to COPASI binary files manually
editing the GNU/Linux <code class="docutils literal"><span class="pre">$HOME/.bashrc</span></code> file as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span># Path to CopasiSE (update this accordingly)
export PATH=$PATH:/path/to/CopasiSE/
</pre></div>
</div>
<p>The correct installation of CopasiSE can be tested with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span># Reload the .bashrc file
source $HOME/.bashrc

CopasiSE -h
&gt; COPASI 4.19 (Build 140)
</pre></div>
</div>
</div>
<div class="section" id="install-latex">
<h4>Install LaTeX<a class="headerlink" href="#install-latex" title="Permalink to this headline">¶</a></h4>
<p>Users are recommended to install LaTeX/texlive using the package manager
of their GNU/Linux distribution. On GNU/Linux Ubuntu machines the
following package is required:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">texlive</span><span class="o">-</span><span class="n">latex</span><span class="o">-</span><span class="n">base</span>
</pre></div>
</div>
<p>The correct installation of LaTeX can be tested with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pdflatex</span> <span class="o">-</span><span class="n">v</span>
<span class="o">&gt;</span> <span class="n">pdfTeX</span> <span class="mf">3.14159265</span><span class="o">-</span><span class="mf">2.6</span><span class="o">-</span><span class="mf">1.40</span><span class="o">.</span><span class="mi">16</span> <span class="p">(</span><span class="n">TeX</span> <span class="n">Live</span> <span class="mi">2015</span><span class="o">/</span><span class="n">Debian</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">kpathsea</span> <span class="n">version</span> <span class="mf">6.2</span><span class="o">.</span><span class="mi">1</span>
<span class="o">&gt;</span> <span class="n">Copyright</span> <span class="mi">2015</span> <span class="n">Peter</span> <span class="n">Breitenlohner</span> <span class="p">(</span><span class="n">eTeX</span><span class="p">)</span><span class="o">/</span><span class="n">Han</span> <span class="n">The</span> <span class="n">Thanh</span> <span class="p">(</span><span class="n">pdfTeX</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="install-sbpipe-via-miniconda3-anaconda3">
<h4>Install SBpipe via Miniconda3/Anaconda3<a class="headerlink" href="#install-sbpipe-via-miniconda3-anaconda3" title="Permalink to this headline">¶</a></h4>
<p>Users need to download and install Anaconda3
(<a class="reference external" href="https://www.continuum.io/downloads">https://www.continuum.io/downloads</a>) or Miniconda3
(<a class="reference external" href="https://conda.io/miniconda.html">https://conda.io/miniconda.html</a>).</p>
<p><strong>1st Method</strong></p>
<p>The following procedure will install SBpipe in a conda environment:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># create a new environment `sbpipe`</span>
<span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">sbpipe</span>

<span class="c1"># activate the environment. The following line can be</span>
<span class="c1"># added to the .bashrc file to skip the activation</span>
<span class="c1"># of this environment every time SBpipe is used.</span>
<span class="c1"># For recent versions of conda, replace `source` with `conda`.</span>
<span class="n">source</span> <span class="n">activate</span> <span class="n">sbpipe</span>

<span class="c1"># install sbpipe and its dependencies (including sbpiper)</span>
<span class="n">conda</span> <span class="n">install</span> <span class="n">sbpipe</span> <span class="o">-</span><span class="n">c</span> <span class="n">pdp10</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="o">-</span><span class="n">c</span> <span class="n">fbergmann</span> <span class="o">-</span><span class="n">c</span> <span class="n">defaults</span>

<span class="c1"># install snakemake (optional)</span>
<span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">bioconda</span> <span class="n">snakemake</span>
</pre></div>
</div>
<p>No further step is needed.</p>
<p><strong>2nd Method</strong></p>
<p>Alternatively, for those users who would like to have an easy access to
the package documentation and test suite, it could be useful to store
SBpipe in a custom path. To do so, SBpipe should be downloaded from the
website or cloned using <code class="docutils literal"><span class="pre">git</span></code>. From a GNU/Linux shell, type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># clone sbpiper using git</span>
<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pdp10</span><span class="o">/</span><span class="n">sbpipe</span><span class="o">.</span><span class="n">git</span>

<span class="c1"># move to sbpipe folder</span>
<span class="n">cd</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">sbpipe</span>

<span class="c1"># install dependencies into isolated environment using Anaconda3/Miniconda3</span>
<span class="n">conda</span> <span class="n">env</span> <span class="n">create</span> <span class="o">--</span><span class="n">name</span> <span class="n">sbpipe</span> <span class="o">--</span><span class="n">file</span> <span class="n">environment</span><span class="o">.</span><span class="n">yaml</span>

<span class="c1"># activate environment. The following line can be</span>
<span class="c1"># added to the .bashrc file to skip the activation</span>
<span class="c1"># of this environment every time SBpipe is used.</span>
<span class="c1"># For recent versions of conda, replace `source` with `conda`.</span>
<span class="n">source</span> <span class="n">activate</span> <span class="n">sbpipe</span>

<span class="c1"># install snakemake (optional)</span>
<span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">bioconda</span> <span class="n">snakemake</span>
</pre></div>
</div>
<p>To run sbpipe from any shell, users need to add ‘sbpipe/scripts’ to
their <code class="docutils literal"><span class="pre">PATH</span></code> environment variable by adding the following lines to
their <code class="docutils literal"><span class="pre">$HOME</span></code>/.bashrc file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span># SBPIPE (update this accordingly)
export PATH=$PATH:/path/to/sbpipe/scripts
</pre></div>
</div>
<p>The .bashrc file should be reloaded to apply the previous edits:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span># Reload the .bashrc file
source $HOME/.bashrc
</pre></div>
</div>
</div>
<div class="section" id="install-sbpipe-s-dependencies-via-provided-scripts">
<h4>Install SBpipe’s dependencies via provided scripts<a class="headerlink" href="#install-sbpipe-s-dependencies-via-provided-scripts" title="Permalink to this headline">¶</a></h4>
<p>For this type of installation, SBpipe should be downloaded from the
website or cloned using <code class="docutils literal"><span class="pre">git</span></code>. Users need to make sure that the
package <code class="docutils literal"><span class="pre">python-pip</span></code> and <code class="docutils literal"><span class="pre">r-base</span></code> are installed. The correct
installation of Python and R can be tested by running the commands:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">V</span>
<span class="o">&gt;</span> <span class="n">Python</span> <span class="mf">3.6</span><span class="o">.</span><span class="mi">4</span>
<span class="n">pip</span> <span class="o">-</span><span class="n">V</span>
<span class="o">&gt;</span> <span class="n">pip</span> <span class="mf">9.0</span><span class="o">.</span><span class="mi">1</span> <span class="kn">from</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ariel</span><span class="o">/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="n">python</span> <span class="mf">3.6</span><span class="p">)</span>

<span class="n">R</span> <span class="o">--</span><span class="n">version</span>
<span class="o">&gt;</span> <span class="n">R</span> <span class="n">version</span> <span class="mf">3.4</span><span class="o">.</span><span class="mi">1</span> <span class="p">(</span><span class="mi">2017</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;Single Candle&quot;</span>
<span class="o">&gt;</span> <span class="n">Copyright</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2017</span> <span class="n">The</span> <span class="n">R</span> <span class="n">Foundation</span> <span class="k">for</span> <span class="n">Statistical</span> <span class="n">Computing</span>
<span class="o">&gt;</span> <span class="n">Platform</span><span class="p">:</span> <span class="n">x86_64</span><span class="o">-</span><span class="n">pc</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span> <span class="p">(</span><span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span>
</pre></div>
</div>
<p>The next step is the installation of SBpipe dependencies. To install
Python dependencies on GNU/Linux, run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">sbpipe</span>
<span class="o">./</span><span class="n">install_pydeps</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>To install SBpipe R dependencies on GNU/Linux, run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">sbpipe</span>
<span class="n">R</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Inside R environment, answer &#39;y&#39; to install packages locally</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">source</span><span class="p">(</span><span class="s1">&#39;install_rdeps.r&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, to run sbpipe from any shell, users need to add
‘sbpipe/scripts’ to their <code class="docutils literal"><span class="pre">PATH</span></code> environment variable by adding the
following lines to their <code class="docutils literal"><span class="pre">$HOME</span></code>/.bashrc file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span># SBPIPE (update this accordingly)
export PATH=$PATH:/path/to/sbpipe/scripts
</pre></div>
</div>
<p>The .bashrc file should be reloaded to apply the previous edits:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span># Reload the .bashrc file
source $HOME/.bashrc
</pre></div>
</div>
<p><strong>NOTE:</strong> If R package dependencies must be compiled, it is worth
checking that the following additional packages are installed in your
machine: <code class="docutils literal"><span class="pre">build-essential</span></code>, <code class="docutils literal"><span class="pre">liblapack-dev</span></code>, <code class="docutils literal"><span class="pre">libblas-dev</span></code>,
<code class="docutils literal"><span class="pre">libcairo-dev</span></code>, <code class="docutils literal"><span class="pre">libssl-dev</span></code>, <code class="docutils literal"><span class="pre">libcurl4-openssl-dev</span></code>, and
<code class="docutils literal"><span class="pre">gfortran</span></code>. These can be installed using the package manager coming
with your distribution. Other packages might be needed, depending on R
dependencies. After installing these packages, <code class="docutils literal"><span class="pre">install_rdeps.r</span></code> must
be executed again.</p>
</div>
<div class="section" id="python-bindings-code-for-copasi-models-optional">
<h4>Python bindings code for COPASI models (optional)<a class="headerlink" href="#python-bindings-code-for-copasi-models-optional" title="Permalink to this headline">¶</a></h4>
<p>If Python bindings for COPASI are installed, SBpipe automatically checks
whether the COPASI model can be loaded and executed, before generating
the data. As of January 2018, this code is released for Python 2.7 and
Python 3.6 on the COPASI website and Anaconda Cloud. The installation of
SBpipe via Miniconda/Anaconda automatically installs this dependency.</p>
</div>
</div>
<div class="section" id="how-to-install-sbpipe-on-windows">
<h3>How to install SBpipe on Windows<a class="headerlink" href="#how-to-install-sbpipe-on-windows" title="Permalink to this headline">¶</a></h3>
<div class="section" id="installation-of-copasi-and-latex">
<h4>Installation of COPASI and LaTeX<a class="headerlink" href="#installation-of-copasi-and-latex" title="Permalink to this headline">¶</a></h4>
<p>Windows users need to install the Windows versions of COPASI and LaTeX
MikTeX <a class="reference external" href="https://miktex.org/">https://miktex.org/</a>.</p>
</div>
<div class="section" id="install-mingw">
<h4>Install MINGW<a class="headerlink" href="#install-mingw" title="Permalink to this headline">¶</a></h4>
<p>We advise users to install <code class="docutils literal"><span class="pre">Git</span> <span class="pre">for</span> <span class="pre">Windows</span></code>
<a class="reference external" href="https://git-for-windows.github.io/">https://git-for-windows.github.io/</a> as a simple Shell (MINGW) running on
Windows. Leave the default setting during installation.</p>
</div>
<div class="section" id="preparation-of-sbpipe-and-copasi-with-mingw">
<h4>Preparation of SBpipe and COPASI with MINGW<a class="headerlink" href="#preparation-of-sbpipe-and-copasi-with-mingw" title="Permalink to this headline">¶</a></h4>
<p>Once <code class="docutils literal"><span class="pre">Git</span> <span class="pre">for</span> <span class="pre">Windows</span></code> is started, a Shell-like window appears and
enables users to run commands. The first step is to clone SBpipe from
GitHub using the command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pdp10</span><span class="o">/</span><span class="n">sbpipe</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>We now need to set up the SBpipe environment variable:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">touch</span> <span class="o">.</span><span class="n">bashrc</span>
<span class="n">wordpad</span> <span class="o">.</span><span class="n">bashrc</span>
</pre></div>
</div>
<p>A Wordpad window should be visible, loading the file <code class="docutils literal"><span class="pre">.bashrc</span></code> . The
following lines must be copied into this file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>#!/bin/bash/

# SBPIPE
export PATH=$PATH:~/sbpipe/scripts

# COPASI (update this accordingly. Use \ to escape spaces)
export PATH=/path/to/copasi/bin/:$PATH

# Optional: activate Anaconda3 environment for SBpipe automatically
source activate sbpipe
</pre></div>
</div>
<p>Save the file and close wordpad. Now you should reload the .bashrc file
to apply the previous changes:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span># Reload the .bashrc file
source $HOME/.bashrc
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h4>Install SBpipe via Miniconda3/Anaconda3<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>See corresponding section for GNU/Linux.</p>
</div>
</div>
<div class="section" id="test-sbpipe">
<h3>Test SBpipe<a class="headerlink" href="#test-sbpipe" title="Permalink to this headline">¶</a></h3>
<p>The correct installation of SBpipe and its dependencies can be verified
by running the following commands. For the correct execution of all
tests, LaTeX must be installed.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># SBpipe version:</span>
<span class="n">sbpipe</span> <span class="o">-</span><span class="n">V</span>
<span class="o">&gt;</span> <span class="n">sbpipe</span> <span class="mf">4.6</span><span class="o">.</span><span class="mi">0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># run model simulation using COPASI (see results in tests/copasi_models):</span>
<span class="n">cd</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">sbpipe</span><span class="o">/</span><span class="n">tests</span>
<span class="n">nosetests</span> <span class="n">test_copasi_sim</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">nocapture</span> <span class="o">--</span><span class="n">verbose</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># run all tests:</span>
<span class="n">nosetests</span> <span class="n">test_suite</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">nocapture</span> <span class="o">--</span><span class="n">verbose</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># regenerate the manuscript figures (see results in tests/insulin_receptor):</span>
<span class="n">nosetests</span> <span class="n">test_suite_manuscript</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">nocapture</span> <span class="o">--</span><span class="n">verbose</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="how-to-use-sbpipe">
<h2>How to use SBpipe<a class="headerlink" href="#how-to-use-sbpipe" title="Permalink to this headline">¶</a></h2>
<p>SBpipe pipelines can be executed natively or via Snakemake, a dedicated
and more advanced tool for running computational pipelines.</p>
<div class="section" id="how-to-run-sbpipe-natively">
<h3>How to run SBpipe natively<a class="headerlink" href="#how-to-run-sbpipe-natively" title="Permalink to this headline">¶</a></h3>
<p>SBpipe is executed via the command <em>sbpipe</em>. The syntax for this command
and its complete list of options can be retrieved by running <em>sbpipe
-h</em>. The first step is to create a new project. This can be done with
the command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sbpipe</span> <span class="o">--</span><span class="n">create</span><span class="o">-</span><span class="n">project</span> <span class="n">project_name</span>
</pre></div>
</div>
<p>This generates the following structure:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">project_name</span><span class="o">/</span>
    <span class="o">|</span> <span class="o">-</span> <span class="n">Models</span><span class="o">/</span>
    <span class="o">|</span> <span class="o">-</span> <span class="n">Results</span><span class="o">/</span>
    <span class="o">|</span> <span class="o">-</span> <span class="p">(</span><span class="n">store</span> <span class="n">configuration</span> <span class="n">files</span> <span class="n">here</span><span class="p">)</span>
</pre></div>
</div>
<p>Models must be stored in the Models/ folder. COPASI data sets used by a
model should also be stored in Models. To run SBpipe, users need to
create a configuration file for each pipeline they intend to run (see
next section). These configuration files should be placed in the root
project folder. In Results/ users will eventually find all the results
generated by SBpipe.</p>
<p>Each pipeline is invoked using a specific option (type <code class="docutils literal"><span class="pre">sbpipe</span> <span class="pre">-h</span></code> for
the complete command set):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># runs model simulation.</span>
<span class="n">sbpipe</span> <span class="o">-</span><span class="n">s</span> <span class="n">config_file</span><span class="o">.</span><span class="n">yaml</span>

<span class="c1"># runs parameter estimation.</span>
<span class="n">sbpipe</span> <span class="o">-</span><span class="n">e</span> <span class="n">config_file</span><span class="o">.</span><span class="n">yaml</span>

<span class="c1"># runs single parameter scan.</span>
<span class="n">sbpipe</span> <span class="o">-</span><span class="n">p</span> <span class="n">config_file</span><span class="o">.</span><span class="n">yaml</span>

<span class="c1"># runs double parameter scan</span>
<span class="n">sbpipe</span> <span class="o">-</span><span class="n">d</span> <span class="n">config_file</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<div class="section" id="pipeline-configuration-files">
<h4>Pipeline configuration files<a class="headerlink" href="#pipeline-configuration-files" title="Permalink to this headline">¶</a></h4>
<p>Pipelines are configured using files (here called configuration files).
These files are YAML files. In SBpipe each pipeline executes three
tasks: data generation, data analysis, and report generation. These
tasks can be activated in each configuration files using the options:</p>
<ul class="simple">
<li>generate_data: True</li>
<li>analyse_data: True</li>
<li>generate_report: True</li>
</ul>
<p>The <code class="docutils literal"><span class="pre">generate_data</span></code> task runs a simulator accordingly to the options
in the configuration file. Hence, this task collects and organises the
reports generated from the simulator. The <code class="docutils literal"><span class="pre">analyse_data</span></code> task
processes the reports to generate plots and compute statistics. Finally,
the <code class="docutils literal"><span class="pre">generate_report</span></code> task generates a LaTeX report containing the
computed plots and invokes the utility <code class="docutils literal"><span class="pre">pdflatex</span></code> to produce a PDF
file. This modularisation allows users to analyse the same data without
having to re-generate it, or to skip the report generation if not
wanted.</p>
<p>Pipelines for parameter estimation or stochastic model simulation can be
computationally intensive. SBpipe allows users to generate simulated
data in parallel using the following options in the pipeline
configuration file:</p>
<ul class="simple">
<li>cluster: “local”</li>
<li>local_cpus: 7</li>
<li>runs: 250</li>
</ul>
<p>The <code class="docutils literal"><span class="pre">cluster</span></code> option defines whether the simulator should be executed
locally (<code class="docutils literal"><span class="pre">local</span></code>: Python multiprocessing), or in a computer cluster
(<code class="docutils literal"><span class="pre">sge</span></code>: Sun Grid Engine (SGE), <code class="docutils literal"><span class="pre">lsf</span></code>: Load Sharing Facility (LSF)).
If <code class="docutils literal"><span class="pre">local</span></code> is selected, the <code class="docutils literal"><span class="pre">local_cpus</span></code> option determines the
maximum number of CPUs to be allocated for local simulations. The
<code class="docutils literal"><span class="pre">runs</span></code> option specifies the number of simulations (or parameter
estimations for the pipeline <code class="docutils literal"><span class="pre">param_estim</span></code>) to be run.</p>
<p>Assuming that the configuration files are placed in the root directory
of a certain project (e.g. project_name/), examples are given as
follow:</p>
<p><strong>Example 1:</strong> configuration file for the pipeline <em>simulation</em></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># True if data should be generated, False otherwise</span>
<span class="n">generate_data</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># True if data should be analysed, False otherwise</span>
<span class="n">analyse_data</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># True if a report should be generated, False otherwise</span>
<span class="n">generate_report</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># The relative path to the project directory</span>
<span class="n">project_dir</span><span class="p">:</span> <span class="s2">&quot;.&quot;</span>
<span class="c1"># The name of the configurator (e.g. Copasi, Python)</span>
<span class="n">simulator</span><span class="p">:</span> <span class="s2">&quot;Copasi&quot;</span>
<span class="c1"># The model name</span>
<span class="n">model</span><span class="p">:</span> <span class="s2">&quot;insulin_receptor_stoch.cps&quot;</span>
<span class="c1"># The cluster type. local if the model is run locally,</span>
<span class="c1"># sge/lsf if run on cluster.</span>
<span class="n">cluster</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span>
<span class="c1"># The number of CPU if local is used, ignored otherwise</span>
<span class="n">local_cpus</span><span class="p">:</span> <span class="mi">7</span>
<span class="c1"># The number of simulations to perform.</span>
<span class="c1"># n&gt;: 1 for stochastic simulations.</span>
<span class="n">runs</span><span class="p">:</span> <span class="mi">40</span>
<span class="c1"># An experimental data set (or blank) to add to the</span>
<span class="c1"># simulated plots as additional layer</span>
<span class="n">exp_dataset</span><span class="p">:</span> <span class="s2">&quot;insulin_receptor_dataset.csv&quot;</span>
<span class="c1"># True if the experimental data set should be plotted.</span>
<span class="n">plot_exp_dataset</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># The alpha level used for plotting the experimental dataset</span>
<span class="n">exp_dataset_alpha</span><span class="p">:</span> <span class="mf">1.0</span>
<span class="c1"># The label for the x axis.</span>
<span class="n">xaxis_label</span><span class="p">:</span> <span class="s2">&quot;Time [min]&quot;</span>
<span class="c1"># The label for the y axis.</span>
<span class="n">yaxis_label</span><span class="p">:</span> <span class="s2">&quot;Level [a.u.]&quot;</span>
</pre></div>
</div>
<p><strong>Example 2:</strong> configuration file for the pipeline <em>single parameter
scan</em></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># True if data should be generated, False otherwise</span>
<span class="n">generate_data</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># True if data should be analysed, False otherwise</span>
<span class="n">analyse_data</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># True if a report should be generated, False otherwise</span>
<span class="n">generate_report</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># The relative path to the project directory</span>
<span class="n">project_dir</span><span class="p">:</span> <span class="s2">&quot;.&quot;</span>
<span class="c1"># The name of the configurator (e.g. Copasi, Python)</span>
<span class="n">simulator</span><span class="p">:</span> <span class="s2">&quot;Copasi&quot;</span>
<span class="c1"># The model name</span>
<span class="n">model</span><span class="p">:</span> <span class="s2">&quot;insulin_receptor_inhib_scan_IR_beta.cps&quot;</span>
<span class="c1"># The variable to scan (as set in Copasi Parameter Scan Task)</span>
<span class="n">scanned_par</span><span class="p">:</span> <span class="s2">&quot;IR_beta&quot;</span>
<span class="c1"># The cluster type. local if the model is run locally,</span>
<span class="c1"># sge/lsf if run on cluster.</span>
<span class="n">cluster</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span>
<span class="c1"># The number of CPU if local is used, ignored otherwise</span>
<span class="n">local_cpus</span><span class="p">:</span> <span class="mi">7</span>
<span class="c1"># The number of simulations to perform per run.</span>
<span class="c1"># n&gt;: 1 for stochastic simulations.</span>
<span class="n">runs</span><span class="p">:</span> <span class="mi">1</span>
<span class="c1"># The number of intervals in the simulation</span>
<span class="n">simulate__intervals</span><span class="p">:</span> <span class="mi">100</span>
<span class="c1"># True if the variable is only reduced (knock down), False otherwise.</span>
<span class="n">ps1_knock_down_only</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># True if the scanning represents percent levels.</span>
<span class="n">ps1_percent_levels</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># The minimum level (as set in Copasi Parameter Scan Task)</span>
<span class="n">min_level</span><span class="p">:</span> <span class="mi">0</span>
<span class="c1"># The maximum level (as set in Copasi Parameter Scan Task)</span>
<span class="n">max_level</span><span class="p">:</span> <span class="mi">100</span>
<span class="c1"># The number of scans (as set in Copasi Parameter Scan Task)</span>
<span class="n">levels_number</span><span class="p">:</span> <span class="mi">10</span>
<span class="c1"># True if plot lines are the same between scans</span>
<span class="c1"># (e.g. full lines, same colour)</span>
<span class="n">homogeneous_lines</span><span class="p">:</span> <span class="kc">False</span>
<span class="c1"># The label for the x axis.</span>
<span class="n">xaxis_label</span><span class="p">:</span> <span class="s2">&quot;Time [min]&quot;</span>
<span class="c1"># The label for the y axis.</span>
<span class="n">yaxis_label</span><span class="p">:</span> <span class="s2">&quot;Level [a.u.]&quot;</span>
</pre></div>
</div>
<p><strong>Example 3:</strong> configuration file for the pipeline <em>double parameter
scan</em></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># True if data should be generated, False otherwise</span>
<span class="n">generate_data</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># True if data should be analysed, False otherwise</span>
<span class="n">analyse_data</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># True if a report should be generated, False otherwise</span>
<span class="n">generate_report</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># The relative path to the project directory</span>
<span class="n">project_dir</span><span class="p">:</span> <span class="s2">&quot;.&quot;</span>
<span class="c1"># The name of the configurator (e.g. Copasi, Python)</span>
<span class="n">simulator</span><span class="p">:</span> <span class="s2">&quot;Copasi&quot;</span>
<span class="c1"># The model name</span>
<span class="n">model</span><span class="p">:</span> <span class="s2">&quot;insulin_receptor_inhib_dbl_scan_InsulinPercent__IRbetaPercent.cps&quot;</span>
<span class="c1"># The 1st variable to scan (as set in Copasi Parameter Scan Task)</span>
<span class="n">scanned_par1</span><span class="p">:</span> <span class="s2">&quot;InsulinPercent&quot;</span>
<span class="c1"># The 2nd variable to scan (as set in Copasi Parameter Scan Task)</span>
<span class="n">scanned_par2</span><span class="p">:</span> <span class="s2">&quot;IRbetaPercent&quot;</span>
<span class="c1"># The cluster type. local if the model is run locally,</span>
<span class="c1"># sge/lsf if run on cluster.</span>
<span class="n">cluster</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span>
<span class="c1"># The number of CPU if local is used, ignored otherwise</span>
<span class="n">local_cpus</span><span class="p">:</span> <span class="mi">7</span>
<span class="c1"># The number of simulations to perform.</span>
<span class="c1"># n&gt;: 1 for stochastic simulations.</span>
<span class="n">runs</span><span class="p">:</span> <span class="mi">1</span>
<span class="c1"># The simulation length (as set in Copasi Time Course Task)</span>
<span class="n">sim_length</span><span class="p">:</span> <span class="mi">10</span>
</pre></div>
</div>
<p><strong>Example 4:</strong> configuration file for the pipeline <em>parameter
estimation</em></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># True if data should be generated, False otherwise</span>
<span class="n">generate_data</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># True if data should be analysed, False otherwise</span>
<span class="n">analyse_data</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># True if a report should be generated, False otherwise</span>
<span class="n">generate_report</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># True if a zipped tarball should be generated, False otherwise</span>
<span class="n">generate_tarball</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># The relative path to the project directory</span>
<span class="n">project_dir</span><span class="p">:</span> <span class="s2">&quot;.&quot;</span>
<span class="c1"># The name of the configurator (e.g. Copasi, Python)</span>
<span class="n">simulator</span><span class="p">:</span> <span class="s2">&quot;Copasi&quot;</span>
<span class="c1"># The model name</span>
<span class="n">model</span><span class="p">:</span> <span class="s2">&quot;insulin_receptor_param_estim.cps&quot;</span>
<span class="c1"># The cluster type. local if the model is run locally,</span>
<span class="c1"># sge/lsf if run on cluster.</span>
<span class="n">cluster</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span>
<span class="c1"># The number of CPU if local is used, ignored otherwise</span>
<span class="n">local_cpus</span><span class="p">:</span> <span class="mi">7</span>
<span class="c1"># The parameter estimation round which is used to distinguish</span>
<span class="c1"># phases of parameter estimations when parameters cannot be</span>
<span class="c1"># estimated at the same time</span>
<span class="nb">round</span><span class="p">:</span> <span class="mi">1</span>
<span class="c1"># The number of parameter estimations</span>
<span class="c1"># (the length of the fit sequence)</span>
<span class="n">runs</span><span class="p">:</span> <span class="mi">250</span>
<span class="c1"># The threshold percentage of the best fits to consider</span>
<span class="n">best_fits_percent</span><span class="p">:</span> <span class="mi">75</span>
<span class="c1"># The number of available data points</span>
<span class="n">data_point_num</span><span class="p">:</span> <span class="mi">33</span>
<span class="c1"># True if 2D all fits plots for 66% confidence levels</span>
<span class="c1"># should be plotted. This can be computationally expensive.</span>
<span class="n">plot_2d_66cl_corr</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># True if 2D all fits plots for 95% confidence levels</span>
<span class="c1"># should be plotted. This can be computationally expensive.</span>
<span class="n">plot_2d_95cl_corr</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># True if 2D all fits plots for 99% confidence levels</span>
<span class="c1"># should be plotted. This can be computationally expensive.</span>
<span class="n">plot_2d_99cl_corr</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># True if parameter values should be plotted in log space.</span>
<span class="n">logspace</span><span class="p">:</span> <span class="kc">True</span>
<span class="c1"># True if plot axis labels should be plotted in scientific notation.</span>
<span class="n">scientific_notation</span><span class="p">:</span> <span class="kc">True</span>
</pre></div>
</div>
<p>Additional examples of configuration files can be found in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sbpipe</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">insulin_receptor</span><span class="o">/</span>
</pre></div>
</div>
<div class="figure" id="id2">
<img alt="SBpipe native workflow" src="_images/sbpipe_workflow.png" />
<p class="caption"><span class="caption-text">SBpipe native workflow</span></p>
</div>
</div>
</div>
<div class="section" id="how-to-run-sbpipe-via-snakemake">
<h3>How to run SBpipe via Snakemake<a class="headerlink" href="#how-to-run-sbpipe-via-snakemake" title="Permalink to this headline">¶</a></h3>
<p>SBpipe pipelines can also be executed using
<a class="reference external" href="https://snakemake.readthedocs.io">Snakemake</a>. Snakemake offers an
infrastructure for running computational pipelines using declarative
rules.</p>
<p>Snakemake can be installed manually via package manager or using the
conda command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Install snakemake (note: it requires python 3+ to run)</span>
<span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">bioconda</span> <span class="n">snakemake</span>
</pre></div>
</div>
<p>SBpipe pipelines for parameter estimation, single/double parameter scan,
and model simulation are also implemented as snakemake files (which
contain the set of rules for each pipeline). These are:</p>
<ul class="simple">
<li>sbpipe_pe.snake</li>
<li>sbpipe_ps1.snake</li>
<li>sbpipe_ps2.snake</li>
<li>sbpipe_sim.snake</li>
</ul>
<p>and are stored on the root folder of SBpipe. The advantage of using
snakemake as pipeline infrastructure is that it offers an extended
command sets compared to the one provided with the standard sbpipe. For
details, run</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">snakemake</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
<p>Snakemake also offers a strong support for dependency management at
coding level and reentrancy at execution level. The former is defined as
a way to precisely define the dependency order of functions. The latter
is the capacity of a program to continue from the last interrupted task.
Benefitting of dependency declaration and execution reentrancy can be
beneficial for running SBpipe on clusters or on the cloud.</p>
<p>Under the current implementation of SBpipe snakefile, the configuration
files described above require the additional field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># The name of the report variables</span>
<span class="n">report_variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;IR_beta_pY1146&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>which contain the names of the variables exported by the simulator. For
the parameter estimation pipeline, <code class="docutils literal"><span class="pre">report_variables</span></code> will contain the
names of the estimated parameters.</p>
<p>For the parameter estimation pipeline, the following option must also be
added:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># An experimental data set (or blank) to add to the</span>
<span class="c1"># simulated plots as additional layer</span>
<span class="n">exp_dataset</span><span class="p">:</span> <span class="s2">&quot;insulin_receptor_dataset.csv&quot;</span>
</pre></div>
</div>
<p>A complete example of configuration file for the parameter estimation
pipeline is the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">simulator</span><span class="p">:</span> <span class="s2">&quot;Copasi&quot;</span>
<span class="n">model</span><span class="p">:</span> <span class="s2">&quot;insulin_receptor_param_estim.cps&quot;</span>
<span class="nb">round</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">runs</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">best_fits_percent</span><span class="p">:</span> <span class="mi">75</span>
<span class="n">data_point_num</span><span class="p">:</span> <span class="mi">33</span>
<span class="n">plot_2d_66cl_corr</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">plot_2d_95cl_corr</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">plot_2d_99cl_corr</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">logspace</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">scientific_notation</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">report_variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;k1&#39;</span><span class="p">,</span><span class="s1">&#39;k2&#39;</span><span class="p">,</span><span class="s1">&#39;k3&#39;</span><span class="p">]</span>
<span class="n">exp_dataset</span><span class="p">:</span> <span class="s2">&quot;insulin_receptor_dataset.csv&quot;</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> As it can be noticed, a configuration files for SBpipe using
snakemake requires less options than the corresponding configuration
file using SBpipe directly. This because Snakemake files is more
automated than SBpipe. Nevertheless, the removal of those additional
options is not necessary for running the configuration file using
Snakemake.</p>
<p>Examples of configuration files for running SBpipe using Snakemake are
in <code class="docutils literal"><span class="pre">tests/snakemake</span></code>.</p>
<p>Examples of commands running SBpipe pipelines using Snakemake are:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># run model simulation</span>
<span class="n">snakemake</span> <span class="o">-</span><span class="n">s</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">sbpipe</span><span class="o">/</span><span class="n">sbpipe_sim</span><span class="o">.</span><span class="n">snake</span> <span class="o">--</span><span class="n">configfile</span> <span class="n">SBPIPE_CONFIG_FILE</span><span class="o">.</span><span class="n">yaml</span> <span class="o">--</span><span class="n">cores</span> <span class="mi">7</span>

<span class="c1"># run model parameter estimation using 40 jobs on an SGE cluster.</span>
<span class="c1"># snakemake waits for output files for 100 s.</span>
<span class="n">snakemake</span> <span class="o">-</span><span class="n">s</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">sbpipe</span><span class="o">/</span><span class="n">sbpipe_pe</span><span class="o">.</span><span class="n">snake</span> <span class="o">--</span><span class="n">configfile</span> <span class="n">SBPIPE_CONFIG_FILE</span><span class="o">.</span><span class="n">yaml</span> <span class="o">--</span><span class="n">latency</span><span class="o">-</span><span class="n">wait</span> <span class="mi">100</span> <span class="o">-</span><span class="n">j</span> <span class="mi">40</span> <span class="o">--</span><span class="n">cluster</span> <span class="s2">&quot;qsub -cwd -V -S /bin/sh&quot;</span>

<span class="c1"># run model parameter parameter scan using 5 jobs</span>
<span class="n">snakemake</span> <span class="o">-</span><span class="n">s</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">sbpipe</span><span class="o">/</span><span class="n">sbpipe_ps1</span><span class="o">.</span><span class="n">snake</span> <span class="o">--</span><span class="n">configfile</span> <span class="n">SBPIPE_CONFIG_FILE</span><span class="o">.</span><span class="n">yaml</span> <span class="o">-</span><span class="n">j</span> <span class="mi">5</span> <span class="o">--</span><span class="n">cluster</span> <span class="s2">&quot;bsub&quot;</span>

<span class="c1"># run model parameter parameter scan using 5 jobs</span>
<span class="n">snakemake</span> <span class="o">-</span><span class="n">s</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">sbpipe</span><span class="o">/</span><span class="n">sbpipe_ps2</span><span class="o">.</span><span class="n">snake</span> <span class="o">--</span><span class="n">configfile</span> <span class="n">SBPIPE_CONFIG_FILE</span><span class="o">.</span><span class="n">yaml</span> <span class="o">-</span><span class="n">j</span> <span class="mi">1</span> <span class="o">--</span><span class="n">cluster</span> <span class="s2">&quot;qsub&quot;</span>
</pre></div>
</div>
<p>If the grid engine supports DRMAA, it can be convenient to use Snakemake
with the option <code class="docutils literal"><span class="pre">--drmaa</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># See the DRMAA Python bindings for a preliminary documentation: https://pypi.python.org/pypi/drmaa</span>
<span class="c1"># The following is an example of configuration for DRMAA for the grid engine installed at the Babraham Institute</span>
<span class="c1"># (Cambridge, UK).</span>

<span class="c1"># load Python 3</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">python3</span><span class="o">/</span><span class="mf">3.5</span><span class="o">.</span><span class="mi">1</span>
<span class="n">alias</span> <span class="n">python</span><span class="o">=</span><span class="n">python3</span>
<span class="c1"># install python drmaa locally</span>
<span class="n">easy_install</span><span class="o">-</span><span class="mf">3.5</span> <span class="o">--</span><span class="n">user</span> <span class="n">drmaa</span>

<span class="c1"># Update accordingly and add the following line to your ~/.bashrc file:</span>
<span class="n">export</span> <span class="n">SGE_ROOT</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gridengine</span>     <span class="c1"># update path if needed</span>
<span class="n">export</span> <span class="n">SGE_CELL</span><span class="o">=</span><span class="n">default</span>
<span class="n">export</span> <span class="n">DRMAA_LIBRARY_PATH</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gridengine</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">lx26</span><span class="o">-</span><span class="n">amd64</span><span class="o">/</span><span class="n">libdrmaa</span><span class="o">.</span><span class="n">so</span><span class="o">.</span><span class="mf">1.0</span>    <span class="c1"># update path if needed</span>
</pre></div>
</div>
<p>Snakemake can now be executed using drmaa as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">snakemake</span> <span class="o">-</span><span class="n">s</span> <span class="o">../../</span><span class="n">sbpipe_sim</span><span class="o">.</span><span class="n">snake</span> <span class="o">--</span><span class="n">configfile</span> <span class="n">ir_model_stoch_simul</span><span class="o">.</span><span class="n">yaml</span> <span class="o">-</span><span class="n">j</span> <span class="mi">200</span> <span class="o">--</span><span class="n">latency</span><span class="o">-</span><span class="n">wait</span> <span class="mi">100</span> <span class="o">--</span><span class="n">drmaa</span> <span class="s2">&quot; -cwd -V -S /bin/sh&quot;</span>
</pre></div>
</div>
<p>See <code class="docutils literal"><span class="pre">snakemake</span> <span class="pre">-h</span></code> for a complete list of commands.</p>
<p>The implementation of SBpipe pipelines for Snakemake is more scalable
and allows for additional controls and resiliance.</p>
<div class="figure" id="id3">
<img alt="snakemake1" src="_images/sbpipe_pe_snake_dag.pdf" />
<p class="caption"><span class="caption-text">Workflow for SBpipe pipeline <code class="docutils literal"><span class="pre">parameter</span> <span class="pre">estimation</span></code> using Snakemake</span></p>
</div>
<div class="figure" id="id4">
<img alt="snakemake2" src="_images/sbpipe_sim_snake_dag.pdf" />
<p class="caption"><span class="caption-text">Workflow for SBpipe pipeline <code class="docutils literal"><span class="pre">simulation</span></code> using Snakemake</span></p>
</div>
<div class="figure" id="id5">
<img alt="snakemake3" src="_images/sbpipe_ps1_snake_dag.pdf" />
<p class="caption"><span class="caption-text">Workflow for SBpipe pipeline <code class="docutils literal"><span class="pre">single</span> <span class="pre">parameter</span> <span class="pre">scan</span></code> using
Snakemake</span></p>
</div>
<div class="figure" id="id6">
<img alt="snakemake4" src="_images/sbpipe_ps2_snake_dag.pdf" />
<p class="caption"><span class="caption-text">Workflow for SBpipe pipeline <code class="docutils literal"><span class="pre">double</span> <span class="pre">parameter</span> <span class="pre">scan</span></code> using
Snakemake</span></p>
</div>
</div>
<div class="section" id="configuration-of-the-mathematical-model">
<h3>Configuration of the mathematical model<a class="headerlink" href="#configuration-of-the-mathematical-model" title="Permalink to this headline">¶</a></h3>
<p>SBpipe can run COPASI models or models coded in any programming language
using a Python wrapper to invoke them.</p>
<div class="section" id="pipelines-running-copasi-models">
<h4>Pipelines running COPASI models<a class="headerlink" href="#pipelines-running-copasi-models" title="Permalink to this headline">¶</a></h4>
<p>A COPASI model must be configured as follow using the command
<code class="docutils literal"><span class="pre">CopasiUI</span></code>:</p>
<p><strong>pipeline: simulation</strong></p>
<ul class="simple">
<li>Tick the flag <em>executable</em> in the Time Course Task.</li>
<li>Select a report template for the Time Course Task.</li>
<li>Save the report in the same folder with the same name as the model
but replacing the extension .cps with .csv (extensions .txt, .tsv, or
.dat are also accepted by SBpipe).</li>
</ul>
<p><strong>pipelines: single or double parameter scan</strong></p>
<ul class="simple">
<li>Tick the flag <em>executable</em> in the Parameter Scan Task.</li>
<li>Select a report template for the Parameter Scan Task.</li>
<li>Save the report in the same folder with the same name as the model
but replacing the extension .cps with .csv (extensions .txt, .tsv, or
.dat are also accepted by SBpipe)</li>
</ul>
<p><strong>pipeline: parameter estimation</strong></p>
<ul class="simple">
<li>Tick the flag <em>executable</em> in the Parameter Estimation Task.</li>
<li>Select the report template for the Parameter Estimation Task.</li>
<li>Save the report in the same folder with the same name as the model
but replacing the extension .cps with .csv (extensions .txt, .tsv, or
.dat are also accepted by SBpipe)</li>
</ul>
<p>For tasks such as parameter estimation using COPASI, it is recommended
to move the data set into the folder <code class="docutils literal"><span class="pre">Models/</span></code> so that the COPASI
model file and its associated experimental data files are stored in the
same folder.</p>
</div>
<div class="section" id="pipelines-running-any-mathematical-model-using-python-as-a-wrapper">
<h4>Pipelines running any mathematical model using Python as a wrapper.<a class="headerlink" href="#pipelines-running-any-mathematical-model-using-python-as-a-wrapper" title="Permalink to this headline">¶</a></h4>
<p>The model/program must be functional and a Python wrapper should be able
to run it via the command <code class="docutils literal"><span class="pre">python</span></code>. The program must receive the
report file name as input argument (see examples in sbpipe/tests/). If
the program generates a model simulation, a report file must be
generated including the column <code class="docutils literal"><span class="pre">Time</span></code>. Report fields must be separated
by TAB, and row names must be discarded. If the program runs a parameter
estimation, a report file must be generated including the objective
value as first column column, and the estimated parameters as following
columns. Rows are the evaluated functions. Report fields must be
separated by TAB, and row names must be discarded.</p>
<p>Users can use Python as a wrapper to execute models coded in any
programming language. The following Python model is essentially a
wrapper invoking an R model called <code class="docutils literal"><span class="pre">sde_periodic_drift.r</span></code>. This Python
wrapper and <code class="docutils literal"><span class="pre">sde_periodic_drift.r</span></code> are stored in the <code class="docutils literal"><span class="pre">Models/</span></code>
folder. The configuration file calls the Python wrapper. This wrapper
code must receive the report file name as input argument and forward it
to the R script. This R script will run a model and store the results in
the received report file name. These data must be stored as described
above.</p>
<p>Python wrapper <code class="docutils literal"><span class="pre">sde_periodic_drift.py</span></code>. This runs
<code class="docutils literal"><span class="pre">sde_periodic_drift.r</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">shlex</span>

<span class="c1"># This is a Python wrapper used to run an R model.</span>
<span class="c1"># The R model receives the report_filename as input</span>
<span class="c1"># and must add the results to it.</span>

<span class="c1"># Retrieve the report file name</span>
<span class="n">report_filename</span> <span class="o">=</span> <span class="s2">&quot;sde_periodic_drift.csv&quot;</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">report_filename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">command</span> <span class="o">=</span> <span class="s1">&#39;Rscript --vanilla &#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;sde_periodic_drift.r&#39;</span><span class="p">)</span> <span class="o">+</span> \
          <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">report_filename</span>

<span class="c1"># Block until command is finished</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">command</span><span class="p">))</span>
</pre></div>
</div>
<p>Configuration file invoking the Python wrapper <code class="docutils literal"><span class="pre">sde_periodic_drift.py</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">generate_data</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">analyse_data</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">generate_report</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">project_dir</span><span class="p">:</span> <span class="s2">&quot;.&quot;</span>
<span class="n">simulator</span><span class="p">:</span> <span class="s2">&quot;Python&quot;</span>
<span class="n">model</span><span class="p">:</span> <span class="s2">&quot;sde_periodic_drift.py&quot;</span>
<span class="n">cluster</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span>
<span class="n">local_cpus</span><span class="p">:</span> <span class="mi">7</span>
<span class="n">runs</span><span class="p">:</span> <span class="mi">14</span>
<span class="n">exp_dataset</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
<span class="n">plot_exp_dataset</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">exp_dataset_alpha</span><span class="p">:</span> <span class="mf">1.0</span>
<span class="n">xaxis_label</span><span class="p">:</span> <span class="s2">&quot;Time&quot;</span>
<span class="n">yaxis_label</span><span class="p">:</span> <span class="s2">&quot;#&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="how-to-report-bugs-or-request-new-features">
<h2>How to report bugs or request new features<a class="headerlink" href="#how-to-report-bugs-or-request-new-features" title="Permalink to this headline">¶</a></h2>
<p>SBpipe is a relatively young project and there is a chance that some
error occurs. The following mailing list should be used for general
questions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sbpipe</span> <span class="n">AT</span> <span class="n">googlegroups</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<p>All the topics discussed in this mailing list are also available at the
website:</p>
<p><a class="reference external" href="https://groups.google.com/forum/#!forum/sbpipe">https://groups.google.com/forum/#!forum/sbpipe</a></p>
<p>To help us better identify and reproduce your problem, some technical
information is needed. This detail data can be found in SBpipe log files
which are stored in ${HOME}/.sbpipe/logs/. When using the mailing list
above, it would be worth providing this extra information.</p>
<p>Issues and feature requests can also be notified using the github issue
tracking system for SBpipe at the web page:</p>
<p><a class="reference external" href="https://github.com/pdp10/sbpipe/issues">https://github.com/pdp10/sbpipe/issues</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">User manual</a><ul>
<li><a class="reference internal" href="#metadata">Metadata</a></li>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#how-to-install-sbpipe-on-gnu-linux">How to install SBpipe on GNU/Linux</a><ul>
<li><a class="reference internal" href="#install-copasi">Install COPASI</a></li>
<li><a class="reference internal" href="#install-latex">Install LaTeX</a></li>
<li><a class="reference internal" href="#install-sbpipe-via-miniconda3-anaconda3">Install SBpipe via Miniconda3/Anaconda3</a></li>
<li><a class="reference internal" href="#install-sbpipe-s-dependencies-via-provided-scripts">Install SBpipe’s dependencies via provided scripts</a></li>
<li><a class="reference internal" href="#python-bindings-code-for-copasi-models-optional">Python bindings code for COPASI models (optional)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-install-sbpipe-on-windows">How to install SBpipe on Windows</a><ul>
<li><a class="reference internal" href="#installation-of-copasi-and-latex">Installation of COPASI and LaTeX</a></li>
<li><a class="reference internal" href="#install-mingw">Install MINGW</a></li>
<li><a class="reference internal" href="#preparation-of-sbpipe-and-copasi-with-mingw">Preparation of SBpipe and COPASI with MINGW</a></li>
<li><a class="reference internal" href="#id1">Install SBpipe via Miniconda3/Anaconda3</a></li>
</ul>
</li>
<li><a class="reference internal" href="#test-sbpipe">Test SBpipe</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-use-sbpipe">How to use SBpipe</a><ul>
<li><a class="reference internal" href="#how-to-run-sbpipe-natively">How to run SBpipe natively</a><ul>
<li><a class="reference internal" href="#pipeline-configuration-files">Pipeline configuration files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-run-sbpipe-via-snakemake">How to run SBpipe via Snakemake</a></li>
<li><a class="reference internal" href="#configuration-of-the-mathematical-model">Configuration of the mathematical model</a><ul>
<li><a class="reference internal" href="#pipelines-running-copasi-models">Pipelines running COPASI models</a></li>
<li><a class="reference internal" href="#pipelines-running-any-mathematical-model-using-python-as-a-wrapper">Pipelines running any mathematical model using Python as a wrapper.</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-report-bugs-or-request-new-features">How to report bugs or request new features</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">SBpipe documentation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="developer_manual.html"
                        title="next chapter">Developer manual</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/user_manual.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="developer_manual.html" title="Developer manual"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="SBpipe documentation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SBpipe 4.6.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Piero Dalle Pezze and Nicolas Le Novère.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>